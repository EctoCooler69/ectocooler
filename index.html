document.addEventListener("DOMContentLoaded", function() {
    let audioElement = document.getElementById('background-audio');
    let muteToggle = document.getElementById('mute-toggle');

    // Unmute the audio after the page has loaded
    if (localStorage.getItem('isMuted') !== 'true') {
        audioElement.muted = false;
        audioElement.play(); // Play the audio after unmuting
        muteToggle.innerText = 'ðŸ”Š';
    }

    // Toggle mute/unmute
    muteToggle.addEventListener('click', function() {
        if (audioElement.muted) {
            audioElement.muted = false;
            audioElement.play(); // Play the audio after unmuting
            muteToggle.innerText = 'ðŸ”Š';
            localStorage.setItem('isMuted', 'false');
        } else {
            audioElement.muted = true;
            muteToggle.innerText = 'ðŸ”‡';
            localStorage.setItem('isMuted', 'true');
        }
    });

    // Handle "Enter" button click to transition from splash to main content
    document.getElementById('enter-button').addEventListener('click', function(event) {
        event.preventDefault(); // Prevent default link behavior
        document.getElementById('splash-screen').style.display = 'none';
        document.getElementById('main-content').style.display = 'block';
    });

    // Fetch prices from CoinGecko API
    async function fetchPrices() {
        const url = 'https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,solana&vs_currencies=usd';

        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }

            const data = await response.json();

            // Update the prices in the nav bar
            document.getElementById('btc-price').innerText = `$${data.bitcoin.usd.toLocaleString()}`;
            document.getElementById('sol-price').innerText = `$${data.solana.usd.toLocaleString()}`;

            // Assuming ECTO is part of your custom tokens; this won't work unless it exists in CoinGecko
            const ectoPrice = data.ecto ? `$${data.ecto.usd.toLocaleString()}` : '$N/A';
            document.getElementById('ecto-price').innerText = ectoPrice;
        } catch (error) {
            console.error('Error fetching price data:', error);
        }
    }

    // Call the fetchPrices function every minute
    setInterval(fetchPrices, 60000);

    // Fetch prices on initial load
    fetchPrices();

    // Contract address copy functionality
    const contractAddress = document.getElementById('contract-address');
    const copiedNotification = document.getElementById('copied-notification');

    contractAddress.addEventListener('click', () => {
        navigator.clipboard.writeText(contractAddress.textContent)
            .then(() => {
                copiedNotification.classList.add('show');
                setTimeout(() => {
                    copiedNotification.classList.remove('show');
                }, 2000);
            });
    });
});
